### 架构作业三个问题

1. 完善Redis的数据结构，明确具体选择哪种数据结构
2. 设计具体的读写业务流程（文字和序列图都可以）
3. 计算Redis Sentinel的性能以及服务器集群数量
4. 架构设计可以允许有一定冗余



##### 试卷存储设计估算

题型设置为选择题（单选、多选）、问答题（含计算题），题量控制在40-60道题。1000万学生，考试频率设置为2周一次，每道题目平均大小150中文，按utf8，为450字节。

###### 总体数据量估算：

​		1000万 x 2（一月4周） x 12（月） x 60（题目数）x 150 Byte（单个题目大小）= 4000G

######性能估算：

​		每次考试都在白天进行，集中在10:00-12:00，以及14:00-16:00，可以视作均分，前后各500万学生参与。又可以合理估计，每次考试时间平均分布在周一到周五，因此每单次考试约有50万人同时参加，集中在两个小时内完成，平均2分钟一道题。qps：50w/2（分钟）*60（秒数） =  4200

##### 数据结构设计：

单套考题数据量：60*450byte/1024=26kb

备选方案1:学生id+整套试卷，则需要26kb x 4600 x 8 /1024 = 1000m/s，对带宽要求太高

备选方案2:根据试卷特性，先有试卷id--- 题目list --- 题目内容，将数据结构设计为分级：

- 最顶层即考卷级别，key值为“exam：”+ 试卷id，采用hash结构
- 题目层，key值为“questions：” + 试卷id，采用list结构
- 题目内容层，key值为题目id，采用sortedset结构，题目本身有序号要求

最终方案用备选方案2.

##### 读写分析

1. 选根据考试（试卷id）获取题目列表

2. 根据题目id，获取对应的题目内容

##### 服务器数量分析以及性能分析

1. 单机存储即可，为了一定冗余，设计成一主两从的结构
2. 一定程度上防止主观下线带来的故障，Setinel选为3个









